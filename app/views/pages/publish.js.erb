<% if @channel_num %>
  <% publish_to "/chat/#{@channel_num}" do %>
    <% if current_user.id == @channel_num.split("_")[0].to_i %>
        var canvas = document.getElementById('sharedCanvas1');
    <% else %>
        var canvas = document.getElementById('sharedCanvas2');
    <% end %>
    var context = canvas.getContext('2d');
    context.beginPath();
    context.moveTo(<%=@prev[0]%>, <%=@prev[1]%>);
    context.lineTo(<%=@line_to[0] %>, <%=@line_to[1]%>);
    context.lineWidth = <%=@line_width %>
    context.lineCap = "round"
    context.strokeStyle = "<%= @line_color %>"
    context.stroke();
    context.beginPath();
    context.moveTo(<%=@line_to[0] %>, <%=@line_to[1]%>);
  <% end %>
<% end %>
